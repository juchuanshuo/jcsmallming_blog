<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<!-- 使用设备的宽度作为视图宽度并禁止初始的缩放,user-scalable = no 属性能够解决 iPad 切换横屏之后触摸才能回到具体尺寸的问题。 -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
	<meta name="description" content="">
	<meta name="author" content="">
	<title>SmallMing blog</title>
	<style type="text/css">
		body {
			display: flex;
			min-height: 100vh;
			flex-direction: column;
		}

		main {
			flex: 1 0 auto;
			background-color: #F6F4F1;
		}

		header {
			flex: 0 0 auto;
		}
	</style>
	<title id="contentTitle"></title>
	<!-- Compiled and minified CSS -->
	<link rel="stylesheet" href="/resource/materialize/css/font.css">
	<link rel="stylesheet" href="/resource/materialize/css/icon+material.css">
	<link rel="stylesheet" href="/resource/materialize/css/materialize.min.css">
	<link rel="stylesheet" href="/resource/materialize/css/blog.css">
	<link rel="stylesheet" href="/resource/font-awesome-4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="/resource/css/auto.css">
</head>

<body>
	<header>
		<div class="navbar-fixed">
			<nav style="background-color:#991c00" role="navigation">
				<div class="nav-wrapper db">
					<a href="/" class="brand-logo">Jcsmallming</a>
					<a href="#" data-target="mobile-demo" class="sidenav-trigger"><i class="material-icons">menu</i></a>
					<ul id="nav-mobile" class="right hide-on-med-and-down">
						<li class="active"><a href="/">首页</a></li>
						<li><a href="content.html">文章</a></li>
						<li><a href="friends.html">友链</a></li>
						<li><a href="aboutMe.html">施工中</a></li>
						<li><a href="messageBoard.html">施工中</a></li>
						<li><a href="transfer.html">施工中</a></li>
					</ul>
				</div>
			</nav>
		</div>
		<ul class="sidenav" id="mobile-demo">
			<li>
				<div class="user-view">
					<div class="background">
						<img src="/resource/img/office.jpg">
					</div>
					<a href="#user"><img class="circle" src="/resource/img/miao.jpg"></a>
					<a href="#name"><span class="white-text name">小明</span></a>
					<a href="#email"><span class="white-text email">1304363358@qq.com</span></a>
				</div>
			</li>
			<li><a href="content.html">文章</a></li>
			<li><a href="friends.html">友链</a></li>
			<li><a href="aboutMe.html">施工中</a></li>
			<li><a href="messageBoard.html">施工中</a></li>
			<li><a href="transfer.html">施工中</a></li>
		</ul>
	</header>
	<main>
		<div class="container" id="container">
			<div class="row">
				<div class="col s12 m8">
					<div id="contentContainer"></div>
				</div>
				<div class="col s12 m4" id="personInfo">
					<div class="card white">
						<div class="center activator" style="background-image:url(/resource/img/office.jpg);height: 200px">
							<img class="circle imgCenter activator" src="/resource/img/miao.jpg" width="100px">
							<i class="iblock"></i>
						</div>
						<div class="card-content center">
							<i class="fa fa-wechat fa-2x activator" aria-hidden="true"></i>&nbsp;&nbsp;
							<a style="color: black;" href="https://github.com/juchuanshuo"><i class="fa fa-github fa-2x" aria-hidden="true"></i></a>&nbsp;&nbsp;
							<a style="color: black;" href="Mailto:1304363358@qq.com"><i class="fa fa-envelope-o fa-fw fa-2x"></i></a>
						</div>
						<div class="card-reveal">
							<span class="card-title grey-text text-darken-4">公众号<i class="material-icons right">close</i></span>
							<div class="center"><img src="/resource/img/ssys.jpg" width="70%" /></div>
						</div>
					</div>
					<div class="card">
						<div class="card-content">
							<span class="card-title grey-text text-darken-4 center">友链</span>
						</div>
						<div class="card-action">
							<a href="http://oew.ink/">Jiatln'blog</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</main>
	<!-- 以下是footer区域 -->
	<footer class="page-footer" style="background-color: #F6F4F1">
		<div class="footer-copyright" style="color: black">
			<div class="container center">© 2018 Copyright Jcsmallming <span class="gh-ico" aria-hidden="true"></span></div>
		</div>
	</footer>
	<a id="top" class="btn btn-floating waves-effect waves-light" style="position: fixed; bottom: 30px; right: 30px; display: none;"><i
		 class="material-icons">publish</i></a>


	<script type="text/javascript" src="resource/jquery/jquery-3.2.1.min.js"></script>
	<script src="/resource/materialize/js/materialize.min.js"></script>
	<script type="text/javascript">
		var pn = 1;
		var imageHeight = 100;
		var imagewidth = 80;
		var br = "";
		$(function () {
			$("#top").click(function () {
				$("html,body").animate({
					scrollTop: 0
				}, 500);
			});
			var t1 = window.setInterval(function () {
				if ($(document).scrollTop() > 0) {
					$("#top").fadeIn();
				} else {
					$("#top").fadeOut();
				}
			}, 10);
			$('.sidenav').sidenav();
			getPage(pn);
			pn++;
		});

		$(window).scroll(function () {
			if ($(document).scrollTop() >= $(document).height() - $(window).height()) { //判断是否已经滚动到页面底部；
				getPage(pn);
				pn++;
			}
		});

		function getPage(pn) {
			if (pn == 1) {
				$("#content").empty();
			}
			$.ajax({
				type: "POST",
				dataType: "json",
				url: "/content/list",
				data: {
					"pn": pn
				},
				contentType: "application/x-www-form-urlencoded",
				success: function (result) {
					var onceContainer = $('<div></div>');
					for (var i = 0; i < result.list.length; i++) {
						var tiny = "";
						if (result.list[i].tinyImg == null || result.list[i].tinyImg == "") {
							tiny = "/resource/tiniImg/nopic.png";
						} else {
							tiny = result.list[i].tinyImg;
						}
						var row = $('<div id="contentCard"></div>').addClass("card");
						var title = $('<div style="margin-left:15px"></div>');
						title.append('<h4 class="contentTitle"><a class="contentTitle" href = "/content/getContent?id=' + result.list[i].contentId + '"><strong>' + result.list[i].contentName + '</div></strong></a>');
						var divImg = $('<div class="col s3 m3"></div>');
						divImg.append('<img height="100px" width="150px" src="' + tiny + '" />');
						let summary = result.list[i].summary;
						/* if (summary.length > 45) {
							summary = summary.substring(0, 45) + "...";
						} */
						var body = $('<div class="row"></div>');
						divImg.appendTo(body);
						var divContent = $('<div class="col s6 m9 offset-s3" style="height:100px"></div>');
						divContent.append('<span class="truncate" id="summary">' + summary + '</span>');
						divContent.append('<span>'+result.list[i].date + '&nbsp;&nbsp;阅读量(' + result.list[i].pageviews + ')&nbsp;&nbsp;<i class="fa fa-tag" aria-hidden="true"></i><a href="#">' + result.list[i].typeName + '</a></span>');
						// divContent.appendTo("#content");
						divContent.appendTo(body);
						row.append(title);
						row.append(body);
						row.appendTo(onceContainer);

					}
					onceContainer.appendTo($("#contentContainer"));
					// Materialize.fadeInImage(onceContainer);
					// $("#content").trigger('create');
				},
				error: function (data) {
					alert("error:" + data.responseText);
				}
			});
		}
	</script>
</body>

</html>